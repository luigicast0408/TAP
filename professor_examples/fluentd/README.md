# ðŸ“˜ Fluentd Example Project

## Overview

This example demonstrates how to run **Fluentd** inside a Docker container to collect and process JSON events sent over HTTP.  
Fluentd acts as a **unified logging layer**, receiving structured data and routing it to various outputs.

---

## Project Structure

```
fluentd/
â”œâ”€â”€ conf/
â”‚   â”œâ”€â”€ fluent.conf        # Main Fluentd configuration file
â”‚   â”œâ”€â”€ sources.conf       # Input sources definition (HTTP endpoint)
â”‚   â”œâ”€â”€ matches.conf       # Output destinations (e.g., logs or files)
â”œâ”€â”€ logs/                  # Logs generated by Fluentd
â”œâ”€â”€ buffer.*               # Buffer and metadata generated during runtime
â””â”€â”€ start-fluentd.sh       # Startup script for running Fluentd via Docker
```

---

## Fluentd Configuration

### **fluent.conf**
```conf
@include conf/sources.conf
@include conf/matches.conf
```
This file includes all configuration fragments â€” keeping the setup modular and organized.

---

### **sources.conf**
Defines where Fluentd receives incoming data.

```conf
<source>
  @type http
  port 9880
  bind 0.0.0.0
  tag test.logs
</source>
```
This starts an HTTP endpoint listening on port **9880** that accepts JSON events.  
Each event is tagged as `test.logs` for routing.

---

### **matches.conf**
Specifies how and where the incoming data should be processed or stored.

```conf
<match test.logs>
  @type file
  path /fluentd/logs/output.log
  append true
</match>
```
All events tagged as `test.logs` will be saved into `/fluentd/logs/output.log` inside the container.

---

## Running Fluentd

To start Fluentd with Docker, run:

```bash
chmod +x start-fluentd.sh
./start-fluentd.sh
```

This script will:

1. Check for an existing container named **fluentd** and remove it.  
2. Mount the local `conf/` and `logs/` directories into the container.  
3. Expose port **9880** to accept HTTP events.  
4. Start Fluentd using the config file `fluent.conf`.

---

## Sending Data to Fluentd

Once Fluentd is running, you can send events via **curl**:

```bash
curl -X POST -H "Content-Type: application/json"   -d '{"event":"purchase","user":"luigi","amount":49.99}'   http://localhost:9880/test.logs
```

Fluentd will log the incoming JSON to `logs/output.log`.

---

## Checking Logs

To view logs generated by Fluentd:

```bash
cat logs/output.log
```

You can also check Fluentdâ€™s internal logs (for debugging):

```bash
docker logs fluentd
```

---

## Cleaning Up

When done, simply stop Fluentd (the container auto-stops when you close the script).  
If a container remains:

```bash
docker rm -f fluentd
```